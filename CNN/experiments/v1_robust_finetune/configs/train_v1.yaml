seed: 42
device: cuda
require_cuda: false

paths:
  train_csv: CNN/data/tier1_splits/train.csv
  val_csv: CNN/data/tier1_splits/val.csv
  test_csv: CNN/data/tier1_splits/test.csv
  g3_data_dir: CNN/data/G3_SGData
  output_dir: CNN/experiments/v1_robust_finetune/outputs
  artifact_dir: CNN/experiments/v1_robust_finetune/artifacts

labels:
  - paper
  - plastic
  - metal
  - glass
  - other_uncertain
  - e-waste
  - textile

model:
  backbone: efficientnet_b0
  pretrained: true
  img_size: 224

phase_a:
  epochs: 15
  lr: 0.001

phase_b:
  epochs: 8
  lr: 0.0002
  val_ratio: 0.2
  prefer_domain_val: true

optimizer:
  name: adamw
  weight_decay: 0.01
  betas: [0.9, 0.999]

scheduler:
  enabled: true
  name: cosine
  min_lr: 0.000001

loss:
  label_smoothing: 0.05

data:
  batch_size: 32
  num_workers: 4
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2
  verify_images: true
  skip_bad_images: true
  max_retry: 5

augment:
  rrc_scale_min: 0.15
  rrc_scale_max: 1.0
  rrc_ratio: [0.75, 1.33]
  scale_down_pad:
    enabled: true
    prob: 0.5
    scale_range: [0.3, 0.7]
    random_position: true
  color_jitter: [0.3, 0.3, 0.3, 0.1]
  affine:
    degrees: 10
    translate: [0.05, 0.05]
    scale: [0.9, 1.1]
    shear: [0.0, 0.0]
    p: 0.3
  perspective:
    distortion: 0.3
    p: 0.2
  blur:
    enabled: false
    kernel: 3
    sigma: [0.1, 2.0]
    p: 0.2
  random_erasing_p: 0.25
  hflip_p: 0.5

mixup_cutmix:
  mixup_alpha: 0.2
  mixup_p: 0.5
  cutmix_alpha: 1.0
  cutmix_p: 0.5

training:
  grad_clip: 1.0
  use_amp: true
  early_stop_patience: 0
  show_progress: true
  log_every: 50

onnx:
  opset: 17
  sanity_images: 5

infer:
  topk: 3
  conf_threshold: 0.75
  margin_threshold: 0.15
